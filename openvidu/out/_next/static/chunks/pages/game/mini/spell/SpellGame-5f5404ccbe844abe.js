(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{7384:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/mini/spell/SpellGame",function(){return t(2698)}])},2698:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var l=t(5893),s=t(7294),o=t(1649),i=t(1163),a=t(6049),r=t.n(a),p=t(6154),c=t(8e3),m=t.n(c),d=t(4593),u=t(3765),_=t(2515);function x(e){let{sec:n,resetSec:t}=e,a=(0,o.I0)(),[c,x]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1),[j,C]=(0,s.useState)(""),[g,S]=(0,s.useState)([]),[v]=(0,s.useState)({}),y=(0,o.v9)(e=>e.room.currentRoomId),N=(0,o.v9)(e=>e.players.tmpPlayers),w=(0,o.v9)(e=>e.spell.currentPlayerId),k=(0,o.v9)(e=>e.player.currentPlayerId),{transcript:G,finalTranscript:b,listening:I,resetTranscript:B,browserSupportsSpeechRecognition:P}=(0,_.x6)(),T=(0,i.useRouter)(),E=()=>{let e=!1;for(let n of g)if(G==n){f("이미 입력된 단어입니다."),e=!0;return}e||(v.current?v.current.send("/mini/spell/confirm/".concat(y),{},JSON.stringify({word:G.trim()})):f("소켓이 연결되지 않았습니다."))},O=()=>{(0,p.Z)({url:"https://ohogame.shop/api/game/mini/spell",headers:{Accept:"application/json","Content-type":"application/json;charset=UTF-8"},method:"POST",data:{id:y}}).then(e=>{let n=e.data;B(),a((0,u.Vn)({id:n.currentPlayerId}));let t=n.firstWord+n.secondWord;C(t),a((0,u.t)(t))}).catch(e=>{e.response?T.push({pathname:"/exception",query:{msg:e.response.data}}):console.log(e)})},L=()=>{v.current=d.L.over(()=>{let e=new(m())("https://ohogame.shop/ws");return e})},W=()=>{v.current.connect({},()=>{v.current.subscribe("/topic/mini/spell/".concat(y),async e=>{var n=JSON.parse(e.body);B(),n.correct?([...g,n.inputWord],S(e=>{let t=[...e,n.inputWord];return t}),a((0,u.Vn)({id:n.currentPlayerId})),t()):f(n.inputWord+" : "+n.msg)})})};return(0,s.useEffect)(()=>{L(),W(),O()},[]),(0,s.useEffect)(()=>{setTimeout(()=>{x(!0)},5e3),setTimeout(()=>{f(!1)},3e3)}),(0,s.useEffect)(()=>{G.trim().length>=2&&w==k&&(_.ZP.stopListening(),setTimeout(()=>{E()},500))},[G]),(0,s.useEffect)(()=>{w==k?_.ZP.startListening({continuous:!0}):_.ZP.stopListening()}),(0,l.jsxs)(l.Fragment,{children:[!1==c?(0,l.jsx)("div",{className:r().modalContainer,children:(0,l.jsxs)("div",{className:r().modalContent,children:[(0,l.jsx)("p",{children:"10초 안에 제시된 초성과 일치하는 단어를 입력하세요."}),(0,l.jsx)("p",{children:"*두 글자의 단어만 입력 가능합니다.*"}),(0,l.jsxs)("h4",{children:["제시된 초성: ",j]})]})}):null,h&&(0,l.jsx)("div",{className:r().modalContainer2,children:(0,l.jsx)("div",{className:r().modalContent2,children:(0,l.jsx)("p",{children:h})})}),(0,l.jsxs)("div",{className:r().wrapper,children:[(0,l.jsxs)("div",{className:r().upperContainer,children:[(0,l.jsxs)("div",{style:{fontSize:"25px"},children:[N[w]&&N[w].nickname," 님의 차례입니다."," ",n,"초 남았습니다."]}),w==k&&(0,l.jsx)("input",{type:"text",placeholder:"단어를 입력하세요",value:G,className:r().inputContainer}),I&&(0,l.jsx)("span",{children:"음성 입력 중.."}),(0,l.jsx)("button",{type:"button",onClick:E,style:{marginLeft:"20px"},children:"제출"}),(0,l.jsx)("div",{children:(0,l.jsx)("img",{src:"/초성_로고.png",style:{width:"450px"}})})]}),(0,l.jsx)("br",{}),(0,l.jsxs)("div",{className:r().redBlock,children:[(0,l.jsx)("img",{src:"/초성_세종대왕_기본.png",style:{position:"absolute",left:"60px",width:"350px",marginTop:"-300px"}}),(0,l.jsx)("div",{className:r().miniBlock1}),(0,l.jsx)("div",{className:r().miniBlock2}),(0,l.jsxs)("h3",{style:{fontFamily:"ChosunCentennial",position:"absolute",left:"170px",zIndex:"1"},children:["초성은 ",j]}),(0,l.jsx)("img",{src:"/초성_두루마리.png",style:{position:"absolute",width:"700px",left:"-130px",marginBottom:"-210px",zIndex:"0"}}),(0,l.jsx)("div",{className:r().wordsContainer,children:g.map((e,n)=>(0,l.jsx)("div",{className:r().word,style:{position:"absolute",marginLeft:"20px",marginTop:"195px",fontFamily:"ChosunCentennial",left:"".concat(n%8*50,"px"),top:"".concat(30*Math.floor(n/8),"px")},children:e},n))}),(0,l.jsx)("h1",{children:n}),(0,l.jsxs)("label",{children:["단어를 입력하세요:",(0,l.jsx)("input",{type:"text",value:G})]}),(0,l.jsx)("button",{type:"button",onClick:E,children:"제출"})]})]})]})}},6049:function(e){e.exports={topSpellCompo:"SpellGame_topSpellCompo__JGsgr",wrapper:"SpellGame_wrapper__MIls_",upperContainer:"SpellGame_upperContainer__r5ZXB",inputContainer:"SpellGame_inputContainer__tYT5x",redBlock:"SpellGame_redBlock__0tDAq",miniBlock1:"SpellGame_miniBlock1__YvVqj",miniBlock2:"SpellGame_miniBlock2__tDl_z",modalContainer:"SpellGame_modalContainer__cTsAY",modalContainer2:"SpellGame_modalContainer2__eWcOa",modalContent:"SpellGame_modalContent__oIJCC",fadeIn:"SpellGame_fadeIn__821fj",modalContent2:"SpellGame_modalContent2__oNSn8",logoImg:"SpellGame_logoImg__QrZCm",gameOver:"SpellGame_gameOver__hKMEH"}}},function(e){e.O(0,[154,515,774,888,179],function(){return e(e.s=7384)}),_N_E=e.O()}]);