(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{3628:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/mini/spell",function(){return t(5391)}])},2698:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var r=t(5893),l=t(7294),s=t(1649),a=t(1163),i=t(6049),o=t.n(i),c=t(6154),p=t(8e3),u=t.n(p),d=t(4593),m=t(3765),_=t(2515);function x(e){let{sec:n,resetSec:t}=e,i=(0,s.I0)(),[p,x]=(0,l.useState)(!1),[h,f]=(0,l.useState)(!1),[j,g]=(0,l.useState)(""),[v,C]=(0,l.useState)([]),[S]=(0,l.useState)({}),y=(0,s.v9)(e=>e.room.currentRoomId),N=(0,s.v9)(e=>e.players.tmpPlayers),I=(0,s.v9)(e=>e.spell.currentPlayerId),k=(0,s.v9)(e=>e.player.currentPlayerId),{transcript:w,finalTranscript:b,listening:G,resetTranscript:P,browserSupportsSpeechRecognition:E}=(0,_.x6)(),B=(0,a.useRouter)(),T=()=>{let e=!1;for(let n of v)if(w==n){f("이미 입력된 단어입니다."),e=!0;return}e||(S.current?S.current.send("/mini/spell/confirm/".concat(y),{},JSON.stringify({word:w.trim()})):f("소켓이 연결되지 않았습니다."))},O=()=>{(0,c.Z)({url:"https://ohogame.shop/api/game/mini/spell",headers:{Accept:"application/json","Content-type":"application/json;charset=UTF-8"},method:"POST",data:{id:y}}).then(e=>{let n=e.data;P(),i((0,m.Vn)({id:n.currentPlayerId}));let t=n.firstWord+n.secondWord;g(t),i((0,m.t)(t))}).catch(e=>{e.response?B.push({pathname:"/exception",query:{msg:e.response.data}}):console.log(e)})},L=()=>{S.current=d.L.over(()=>{let e=new(u())("https://ohogame.shop/ws");return e})},W=()=>{S.current.connect({},()=>{S.current.subscribe("/topic/mini/spell/".concat(y),async e=>{var n=JSON.parse(e.body);P(),n.correct?([...v,n.inputWord],C(e=>{let t=[...e,n.inputWord];return t}),i((0,m.Vn)({id:n.currentPlayerId})),t()):f(n.inputWord+" : "+n.msg)})})};return(0,l.useEffect)(()=>{L(),W(),O()},[]),(0,l.useEffect)(()=>{setTimeout(()=>{x(!0)},5e3),setTimeout(()=>{f(!1)},3e3)}),(0,l.useEffect)(()=>{w.trim().length>=2&&I==k&&(_.ZP.stopListening(),setTimeout(()=>{T()},500))},[w]),(0,l.useEffect)(()=>{I==k?_.ZP.startListening({continuous:!0}):_.ZP.stopListening()}),(0,r.jsxs)(r.Fragment,{children:[!1==p?(0,r.jsx)("div",{className:o().modalContainer,children:(0,r.jsxs)("div",{className:o().modalContent,children:[(0,r.jsx)("p",{children:"10초 안에 제시된 초성과 일치하는 단어를 입력하세요."}),(0,r.jsx)("p",{children:"*두 글자의 단어만 입력 가능합니다.*"}),(0,r.jsxs)("h4",{children:["제시된 초성: ",j]})]})}):null,h&&(0,r.jsx)("div",{className:o().modalContainer2,children:(0,r.jsx)("div",{className:o().modalContent2,children:(0,r.jsx)("p",{children:h})})}),(0,r.jsxs)("div",{className:o().wrapper,children:[(0,r.jsxs)("div",{className:o().upperContainer,children:[(0,r.jsxs)("div",{style:{fontSize:"25px"},children:[N[I]&&N[I].nickname," 님의 차례입니다."," ",n,"초 남았습니다."]}),I==k&&(0,r.jsx)("input",{type:"text",placeholder:"단어를 입력하세요",value:w,className:o().inputContainer}),G&&(0,r.jsx)("span",{children:"음성 입력 중.."}),(0,r.jsx)("button",{type:"button",onClick:T,style:{marginLeft:"20px"},children:"제출"}),(0,r.jsx)("div",{children:(0,r.jsx)("img",{src:"/초성_로고.png",style:{width:"450px"}})})]}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{className:o().redBlock,children:[(0,r.jsx)("img",{src:"/초성_세종대왕_기본.png",style:{position:"absolute",left:"60px",width:"350px",marginTop:"-300px"}}),(0,r.jsx)("div",{className:o().miniBlock1}),(0,r.jsx)("div",{className:o().miniBlock2}),(0,r.jsxs)("h3",{style:{fontFamily:"ChosunCentennial",position:"absolute",left:"170px",zIndex:"1"},children:["초성은 ",j]}),(0,r.jsx)("img",{src:"/초성_두루마리.png",style:{position:"absolute",width:"700px",left:"-130px",marginBottom:"-210px",zIndex:"0"}}),(0,r.jsx)("div",{className:o().wordsContainer,children:v.map((e,n)=>(0,r.jsx)("div",{className:o().word,style:{position:"absolute",marginLeft:"20px",marginTop:"195px",fontFamily:"ChosunCentennial",left:"".concat(n%8*50,"px"),top:"".concat(30*Math.floor(n/8),"px")},children:e},n))}),(0,r.jsx)("h1",{children:n}),(0,r.jsxs)("label",{children:["단어를 입력하세요:",(0,r.jsx)("input",{type:"text",value:w})]}),(0,r.jsx)("button",{type:"button",onClick:T,children:"제출"})]})]})]})}},5391:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var r=t(5893),l=t(7294),s=t(1649),a=t(1163),i=t(6049),o=t.n(i),c=t(2698);function p(){let[e,n]=(0,l.useState)(!0),[t,i]=(0,l.useState)(0),p=(0,l.useRef)(30),u=(0,l.useRef)(null),d=(0,s.v9)(e=>e.players.tmpPlayers),m=(0,s.v9)(e=>e.spell.currentPlayerId);return(0,l.useEffect)(()=>(u.current=setInterval(()=>{i(p.current%60),p.current-=1},1e3),()=>clearInterval(u.current)),[]),(0,l.useEffect)(()=>{p.current<=-1&&(console.log("시간 초과"),n(!1),clearInterval(u.current))}),(0,r.jsx)("div",{className:o().topSpellCompo,children:e?(0,r.jsx)("div",{children:(0,r.jsx)(c.default,{sec:t,resetSec:()=>{p.current=30,i(30)}})}):(0,r.jsx)(function(){return(0,a.useRouter)(),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:o().gameOver,children:[(0,r.jsx)("img",{src:"/초성_게임오버.png"}),(0,r.jsxs)("h1",{children:["'",d[m].nickname,"' 님의 패배입니다."]})]})})},{})})}},6049:function(e){e.exports={topSpellCompo:"SpellGame_topSpellCompo__JGsgr",wrapper:"SpellGame_wrapper__MIls_",upperContainer:"SpellGame_upperContainer__r5ZXB",inputContainer:"SpellGame_inputContainer__tYT5x",redBlock:"SpellGame_redBlock__0tDAq",miniBlock1:"SpellGame_miniBlock1__YvVqj",miniBlock2:"SpellGame_miniBlock2__tDl_z",modalContainer:"SpellGame_modalContainer__cTsAY",modalContainer2:"SpellGame_modalContainer2__eWcOa",modalContent:"SpellGame_modalContent__oIJCC",fadeIn:"SpellGame_fadeIn__821fj",modalContent2:"SpellGame_modalContent2__oNSn8",logoImg:"SpellGame_logoImg__QrZCm",gameOver:"SpellGame_gameOver__hKMEH"}}},function(e){e.O(0,[154,515,774,888,179],function(){return e(e.s=3628)}),_N_E=e.O()}]);